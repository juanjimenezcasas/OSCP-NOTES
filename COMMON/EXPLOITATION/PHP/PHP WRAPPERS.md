
## DESCRIPTION

PHP offers a variety of protocol wrappers to enhance the language's capabilities. For example, PHP wrappers can be used to represent and access local or remote filesystems. We can use these wrappers to bypass filters or obtain code execution via _File Inclusion_ vulnerabilities in PHP web applications. While we'll only examine the **php://filter**[1](https://portal.offsec.com/courses/pen-200-2023/books-and-videos/modal/modules/common-web-application-attacks/file-inclusion-vulnerabilities/php-wrappers#fn1) and **data://**[2](https://portal.offsec.com/courses/pen-200-2023/books-and-videos/modal/modules/common-web-application-attacks/file-inclusion-vulnerabilities/php-wrappers#fn2) wrappers, many are available.[3](https://portal.offsec.com/courses/pen-200-2023/books-and-videos/modal/modules/common-web-application-attacks/file-inclusion-vulnerabilities/php-wrappers#fn3)

We can use the **php://filter** wrapper to display the contents of files either with or without encodings like _ROT13_[4](https://portal.offsec.com/courses/pen-200-2023/books-and-videos/modal/modules/common-web-application-attacks/file-inclusion-vulnerabilities/php-wrappers#fn4) or _Base64_.[5](https://portal.offsec.com/courses/pen-200-2023/books-and-videos/modal/modules/common-web-application-attacks/file-inclusion-vulnerabilities/php-wrappers#fn5) In the previous section, we covered using LFI to include the contents of files. Using **php://filter**, we can also display the contents of executable files such as **.php**, rather than executing them. This allows us to review PHP files for sensitive information and analyze the web application's logic.

#### Mas información
* https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity#php-wrappers


## EXPLOITATION

### OPTION 1: FILTER -> PARA LEER CODIGO PHP CUANDO ES INTERPETADO POR EL SERVIDOR

![[Pasted image 20230413200600.png]]

![[Pasted image 20230413200617.png]]

Tambien lo puedes explotar en un lfi (interesante para ficheros de backup o contraseñas)

![[Pasted image 20230413201139.png]]


![[Pasted image 20230615182644.png]]
### OPTION 2: DATA -> PARA EJECUTAR COMANDO

![[Pasted image 20230413200655.png]]

![[Pasted image 20230413200709.png]]
![[Pasted image 20230413201652.png]]

## MACHINES

* Hack The Box: 

